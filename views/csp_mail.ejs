<!doctype html>
<html lang="ja">
	<head>
		<style>
			.disposition {
				display: inline-block;
				padding: 0.25em 0.5em;
				border-radius: 0.25em;
				color: #fff;
				line-height: 1;
			}

			.disposition.-enforce {
				background-color: #337ab7;
			}

			.disposition.-report {
				background-color: #36c6d3;
			}

			table {
				border-collapse: collapse;
			}

			th,
			td {
				padding: 0.5em;
				border: 1px solid;
			}

			th {
				background: #eee;
				text-align: left;
			}

			dt {
				font-weight: bold;
			}

			dd {
				margin-left: 1em;
			}
		</style>
	</head>
	<body>
		<p><%= reportings.length %>件のレポート</p>

		<%_ reportings.forEach(({ body, user_agent: userAgent }, index) => { _%> <%_ if (index > 0) { _%>
		<hr />
		<%_ } _%>

		<p>
			<%_ if (body.disposition === 'enforce') { _%>
			<span class="disposition -enforce">Enforce</span>
			<%_ } else { _%>
			<span class="disposition -report">Report Only</span>
			<%_ } _%>
		</p>

		<table>
			<tbody>
				<tr>
					<th><code>documentURL</code></th>
					<td>
						<a href="<%= body.documentURL %>"><%= body.documentURL %></a>
					</td>
				</tr>
				<tr>
					<th><code>referrer</code></th>
					<td><%= body.referrer %></td>
				</tr>
				<tr>
					<th><code>blockedURL</code></th>
					<td><%= body.blockedURL %></td>
				</tr>
				<tr>
					<th><code>effectiveDirective</code></th>
					<td><%= body.effectiveDirective %></td>
				</tr>
				<tr>
					<th><code>originalPolicy</code></th>
					<td><%= body.originalPolicy %></td>
				</tr>
				<tr>
					<th><code>sourceFile</code></th>
					<td><%= body.sourceFile %></td>
				</tr>
				<tr>
					<th><code>sample</code></th>
					<td><%= body.sample %></td>
				</tr>
				<tr>
					<th><code>statusCode</code></th>
					<td><%= body.statusCode %></td>
				</tr>
				<tr>
					<th><code>lineNumber</code></th>
					<td><%= body.lineNumber %></td>
				</tr>
				<tr>
					<th><code>columnNumber</code></th>
					<td><%= body.columnNumber %></td>
				</tr>
			</tbody>
		</table>

		<p><%= userAgent %></p>
		<%_ }); _%>

		<dl>
			<dt>IP アドレス</dt>
			<dd><a href="https://ja.asuka.io/whois/<%= ip %>"><%= ip %></a></dd>
		</dl>
	</body>
</html>
